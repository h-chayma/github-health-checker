<div class="container mt-4">
  <div class="header-container bg-dark text-light p-4 rounded mb-4 text-center">
    <h1>Repository Health Checker</h1>
    <p>Welcome to the Repository Health Checker! This tool allows you to assess the health of GitHub repositories by
      checking key metrics such as the number of open issues, stars, forks, and recent activity. Enter a GitHub
      username and repository name to get detailed insights on repository activity, including recent pull requests
      and commit statistics.</p>
    <div class="row mb-3">
      <div class="col">
        <input type="text" [(ngModel)]="owner" class="form-control" placeholder="Github Username" required>
      </div>
      <div class="col">
        <input type="text" [(ngModel)]="repo" class="form-control" placeholder="Repository name" required>
      </div>
    </div>
    <div class="button-group d-flex justify-content-center gap-3">
      <a class="btn btn-outline-light" href="https://github.com/"><i class="fa-brands fa-github"></i> GITHUB</a>
      <button class="btn btn-success" (click)="checkRepoHealth()"><i class="fa-solid fa-circle-check"></i> Check
        Health</button>
      <button class="btn btn-secondary" onclick="openHelpModal()"><i class="fa-solid fa-circle-info"></i>
        HELP</button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-spinner">
    <img src="assets/images/loading.gif" alt="Loading..." />
    <p class="loading-text text-dark">Loading...</p>
  </div>

  <div *ngIf="repository" class="row">
    <div class="col-md-12 mb-4">
      <div class="card text-light bg-dark rounded">
        <div class="card-body">
          <h5 class="card-title">
            <i class="fa-solid fa-user"></i> Owner Information
          </h5>
          <div class="d-flex align-items-center">
            <img [src]="repository.owner.avatar_url" alt="Owner Avatar" class="rounded-circle me-3" width="80"
              height="80">
            <div>
              <p class="mb-1">Username: <a href="{{ repository.owner.html_url }}" target="_blank"
                  class="text-info text-decoration-none">{{ repository.owner.login }}</a></p>
              <p class="mb-1">Profile ID: {{ repository.owner.id }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card text-light bg-dark rounded">
        <div class="card-body">
          <h5 class="card-title">
            <i class="fa-solid fa-book"></i> Repository: <a href="{{ repository.html_url }}" target="_blank"
              class="text-info text-decoration-none">{{ repository.name }}</a>
          </h5>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Open Issues:</p>
            <p class="mb-1 text-info">{{ repository.open_issues_count }}</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Stars:</p>
            <p class="mb-1 text-info">{{ repository.stargazers_count }}</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Forks:</p>
            <p class="mb-1 text-info">{{ repository.forks_count }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card text-light bg-dark rounded">
        <div class="card-body">
          <h5 class="card-title">
            <i class="fas fa-chart-line"></i> Activity Overview
          </h5>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Last Commit:</p>
            <p class="mb-1 text-warning">{{ daysSinceLastCommit }} Days Ago</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Total Commits:</p>
            <p class="mb-1 text-info">{{ commitActivity.length }}</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Contributors:</p>
            <p class="mb-1 text-info">{{ contributorsCount }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card text-light bg-dark rounded">
        <div class="card-body">
          <h5 class="card-title">
            <i class="fas fa-code-branch"></i> Recent Pull Requests
          </h5>
          <ul class="list-group list-group-flush">
            <li class="list-group-item bg-dark text-light" *ngFor="let pr of pullRequests | slice:0:4">
              #{{ pr.number }} - {{ pr.title }}
              <span class="badge float-end" [ngClass]="{
                              'bg-info': pr.state === 'closed',
                              'bg-danger': pr.state === 'open'
                          }">{{ pr.state | titlecase }}</span>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card text-light bg-dark rounded">
        <div class="card-body">
          <h5 class="card-title">
            <i class="fas fa-star"></i> Additional Repository Insights
          </h5>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Watchers:</p>
            <p class="mb-1 text-info">{{ repository.watchers_count }}</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Languages:</p>
            <p class="mb-1 text-info">{{ repository.language }}</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">License:</p>
            <p class="mb-1 text-info">{{ repository.license?.name || 'N/A' }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<footer class="bg-dark text-light text-center py-4 mt-4">
  <div class="container">
    <p>&copy; 2024 Repository Health Checker. All rights reserved.</p>
    <p>Follow us on <a href="https://github.com/h-chayma" class="text-info">GitHub</a> | <a
        href="https://chaymafarhat.netlify.app/" class="text-info">Website</a></p>
  </div>
</footer>